# Base Knowledge

## Assembly <a href="#docs-internal-guid-81e98de1-7fff-86b8-ae94-fd25bd4e50ca" id="docs-internal-guid-81e98de1-7fff-86b8-ae94-fd25bd4e50ca"></a>

Learn it from here. It’s an excellent course.

{% embed url="http://opensecuritytraining.info/IntroX86.html" %}

## Heap

### **Heap Structure**

Excellent article:

{% embed url="https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/" %}

#### **Arena**

At the highest level, there are arenas, which are collections of memory. The purpose of arenas is to have separate memory spaces for different threads. That means that different threads can access their own memory spaces, and don’t have to share the same space. Doing it this way is faster, because otherwise the shared memory would have to be locked and freed when used by each thread.

There is a maximum limit on the amount of arenas, though.

For 32 bit systems:

&#x20;    Number of arenas = 2 \* number of cores.

For 64 bit systems:

&#x20;    Number of arenas = 8 \* number of cores.

When the limit for the amount of arenas is reached, then arenas start to become shared between threads. Once again, threads will have to lock and free their arenas when they want to use them. But at least every thread doesn’t have to completely lock the whole memory space, just one arena.

As a side note, once a thread chooses an arena for the first time, then that thread will keep using that same arena in the future as well afaik.

_Note: There are some differences between the main arena and a thread’s arena. Read the_ [_article_](https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/) _to find out more._

#### **Heap**

Heaps are a part of arenas. To begin with every arena contains only one heap. However, when this heap segment runs out of space, a new heap (non contiguous region) gets mmap’d to this arena.

Note: Heaps (as well as arenas) have headers. And there are differences between a main arena’s heap and a thread arena’s heap. Read the [article](https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/) to find out more.
