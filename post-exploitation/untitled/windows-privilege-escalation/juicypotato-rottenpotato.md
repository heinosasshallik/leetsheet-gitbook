# JuicyPotato/RottenPotato

## Short **Summary**

If an user account you control has the SEImpersonate token (which most service accounts have), then you can get root.

This exploit was effectively **patched** in Win10 1809 and Windows Server 2019.

{% embed url="https://github.com/ohpe/juicy-potato" %}

## Explanation

If your user has **SeImpersonate** or **SeAssignPrimaryToken** privileges then you are effectively SYSTEM. Normal users donâ€™t usually have these, but service-level users might. You can check this with `whoami /all` under "Privileges".



You also need to be able to call a DCOM service, which:

1. implements the IMarshal interface
2. runs as an elevated user (SYSTEM, Administrator, ...)

Normally this is port 6666, but there are other such services, in case that one is blocked.

{% embed url="https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/" %}
Technical explanation of RottenPotato, which JuicyPotato is based on
{% endembed %}

{% embed url="https://www.youtube.com/watch?v=QRpfvmMbDMg" %}
Blackhat technical talk about tokens
{% endembed %}





