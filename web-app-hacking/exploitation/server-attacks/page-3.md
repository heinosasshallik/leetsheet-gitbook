# Unrestricted File Upload

Unrestricted File Upload is a security vulnerability where an attacker can upload arbitrary files with attacker-controlled content, potentially to arbitrary locations.

Unrestricted file upload may be used to get:

* Remote Code Execution, especially in PHP
* Cross-Site Scripting, if you can add or overwrite a file that contains HTML
* XML External Entities: If the website uses an insecure XML parser, then you might be able to exploit an XXE vulnerability by getting the insecure parser to parse a malicious XML file. In that case, the file upload vulnerability can be used to smuggle a malicious XML file onto the web server for exploitation.

## PHP Tricks

Some tricks to try to bypass mitigations and exploit the vulnerability on PHP

### Bypass file extension check

If you aren't allowed to upload `.php` files, try uploading these files:

* &#x20;`.php3` or `.php5`  - might not be filtered, but might be handled like `.php`
* &#x20; `.php.test` files.  If Apache doesn't have handler for `.php.test`, then it might instead handle it as `.php`
* `shell.jpg.php` - just in case the filetype check is poorly implemented

